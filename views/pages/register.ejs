<!-- views/pages/register.ejs -->

<!DOCTYPE html>
<html lang="en">
    <head>
        <% include ../partial/head %>
        <title>Registration Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    </head>
    <style>
        body {
            background-image: url('data:image/svg+xml,%3Csvg width="52" height="26" viewBox="0 0 52 26" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%239C92AC" fill-opacity="0.4"%3E%3Cpath d="M10 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4v2c-3.314 0-6-2.686-6-6 0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6zm25.464-1.95l8.486 8.486-1.414 1.414-8.486-8.486 1.414-1.414z" /%3E%3C/g%3E%3C/g%3E%3C/svg%3E');
        }
    </style>
    <body>
        <div class="jumbotron">
            <% if (failure) { %>
                <div class="alert alert-dismissible alert-danger">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    <strong>Oh snap! </strong>Username already taken, please try something else and submit again.
                </div>
            <% } %>
            <h1 class="display-3">Registration Page</h1>
            <form action="/user-register" method="post">
                <fieldset>
                    <legend>Personal Information</legend>
                    <!-- <div class="form-group row">
                    <label for="staticEmail" class="col-sm-2 col-form-label">Email</label>
                    <div class="col-sm-10">
                    <input type="text" readonly="" class="form-control-plaintext" id="staticEmail" value="email@example.com">
                </div>
            </div> -->
            <div class="form-group">
                <label for="email">Email address</label>
                <input type="email" name="username" class="form-control" id="email" aria-describedby="email" placeholder="Please enter your email address" required>
                <small id="email" class="form-text text-muted">We'll never share your email with anyone else.</small>
            </div>
            <!-- <div class="form-group">
                <label for="username">Username</label>
                <input type="text" name="username" class="form-control" id="username" aria-describedby="username" placeholder="Please enter your username" required>
            </div> -->
            <div class="form-group" id="password-container">
                <label for="password">Password</label>
                <input type="password" name="password" class="form-control" id="password" placeholder="Please enter your password" required>
            </div>
            <div class="form-group" id="password-confirm-container">
                <label for="password-confirm">Confirm password</label>
                <input type="password" name="password_confirm"  class="form-control" id="password-confirm" placeholder="Please enter your password again" required>
                <div id="message"></div>
            </div>
            <!-- <div class="form-group">
            <label for="exampleSelect1">Example select</label>
            <select class="form-control" id="exampleSelect1">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
    </div> -->
    <!-- <div class="form-group">
    <label for="exampleSelect2">Example multiple select</label>
    <select multiple="" class="form-control" id="exampleSelect2">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    </select>
    </div> -->
    <!-- <div class="form-group">
    <label for="exampleTextarea">Example textarea</label>
    <textarea class="form-control" id="exampleTextarea" rows="3"></textarea>
    </div>
    <div class="form-group">
    <label for="exampleInputFile">File input</label>
    <input type="file" class="form-control-file" id="exampleInputFile" aria-describedby="fileHelp">
    <small id="fileHelp" class="form-text text-muted">This is some placeholder block-level help text for the above input. It's a bit lighter and easily wraps to a new line.</small>
    </div> -->
    <!-- <div class="form-group has-danger">
      <label class="form-control-label" for="inputDanger1">Invalid input</label>
      <input type="text" value="wrong value" class="form-control is-invalid" id="inputInvalid">
      <div class="invalid-feedback">Sorry, that username's taken. Try another?</div>
    </div>
    <div class="form-group has-success">
      <label class="form-control-label" for="inputSuccess1">Valid input</label>
      <input type="text" value="correct value" class="form-control is-valid is-invalid" id="inputValid">
      <div class="valid-feedback">Success! You've done it.</div>
    </div> -->
    <fieldset class="form-group">
        <legend>Identity</legend>
        <label>You are </label>
        <div class="form-check">
            <label class="form-check-label">
                <input type="radio" class="form-check-input" name="identity" id="customer" value="customer" checked="">
                a customer.
            </label>
        </div>
        <div class="form-check">
            <label class="form-check-label">
                <input type="radio" class="form-check-input" name="identity" id="staff" value="staff">
                a staff.
            </label>
        </div>
        <div class="form-check disabled">
            <label class="form-check-label">
                <input type="radio" class="form-check-input" name="identity" id="both" value="both" disabled="">
                all of the above.
            </label>
        </div>
    </fieldset>
    <!-- <fieldset class="form-group">
    <legend>Checkboxes</legend>
    <div class="form-check">
    <label class="form-check-label">
    <input class="form-check-input" type="checkbox" value="" checked="">
    Option one is this and thatâ€”be sure to include why it's great
    </label>
    </div>
    <div class="form-check disabled">
    <label class="form-check-label">
    <input class="form-check-input" type="checkbox" value="" disabled="">
    Option two is disabled
    </label>
    </div>
    </fieldset> -->
    <button type="submit" class="btn btn-primary" id="submit" disabled>Submit</button>
    <button type="reset" class="btn btn-primary">Reset</button>
    <button type="button" class="btn btn-primary" onclick="location.href = '/'">Back</button>
    </fieldset>
    </form>
    </div>
        <script>
        $(document).ready(function() {
            // var referrer = document.referrer;
            // var success = getMessages();
            // if (!success) {
            //     $('#alert').css("display", "block");
            // }
            // else {
            //     console.log("Seems normal.");
            // };
            $('#password, #password-confirm').on('keyup', function () {
                // console.log("Hi~");
                if ($('#password').val() == $('#password-confirm').val()) {
                    // console.log("Here");
                    if (($('#password-container').hasClass('has-danger')) && ($('#password-confirm-container').hasClass('has-danger'))) {
                        // console.log("remove");
                        $('#password-container, #password-confirm-container').removeClass("has-danger");
                    };

                    $('#password-container, #password-confirm-container').addClass("has-success");

                    if (($('#password').hasClass('is-invalid')) && ($('#password-confirm').hasClass('is-invalid'))) {
                        $('#password, #password-confirm').removeClass("is-invalid");
                    };

                    $('#password, #password-confirm').addClass("is-valid");

                    if ($('#message').hasClass('invalid-feedback')) {
                        $('#message').removeClass("invalid-feedback");
                    };
                    // $('#message').html("The passwords are consistent.").css("color", "green");
                    $('#message').addClass("valid-feedback");
                    $('#message').text("The passwords are consistent.");
                    $('#submit').removeAttr("disabled");
                    // console.log(document.getElementById("submit").classList);
                }
                else {
                    // console.log("There");
                    if (($('#password-container').hasClass('has-success')) && ($('#password-confirm-container').hasClass('has-success'))) {
                        $('#password-container, #password-confirm-container').removeClass("has-success");
                    };

                    $('#password-container, #password-confirm-container').addClass("has-danger");

                    if (($('#password').hasClass('is-valid')) && ($('#password-confirm').hasClass('is-valid'))) {
                        // console.log("done");
                        $('#password, #password-confirm').removeClass("is-valid");
                    };

                    $('#password, #password-confirm').addClass("is-invalid");

                    if ($('#message').hasClass('valid-feedback')) {
                        $('#message').removeClass("valid-feedback");
                    };
                    // console.log("Hi");
                    $('#message').addClass("invalid-feedback");
                    $('#message').text("Sorry, the passwords are not consistent, please try again.");
                    // $('#message').html("Sorry, the passwords are not consistent, please try again.").css("color", "red");
                    // console.log($('#message').text());

                    $('#submit').prop("disabled", "true");
                };
                // console.log(document.getElementById("message").classList);
                // console.log($("#password-confirm-container").hasClass("has-danger"));
            });
            // console.log($("#password-confirm-container").hasClass("has-danger"));
        });
        // console.log($('#password-confirm').hasClass("has-danger"));
        // console.log($('#password-container').classList);
        </script>
    </body>
</html>
